name: Auto Commit

on:
  schedule:
    - cron: "0 */2 * * *"

permissions:
  contents: write

jobs:
  auto_commit:
    runs-on: ubuntu-latest
    steps:
      - name: Debug Ref
        run: echo "::debug::Ref = ${{ github.ref }}"

      - name: Checkout Repository
        uses: actions/checkout@v3
        with:
          persist-credentials: false
          fetch-depth: 0

      - name: Update Timestamp
        run: |
          date -u '+%Y-%m-%dT%H:%M:%SZ' > LAST_UPDATED

      - name: Commit Changes
        run: |
          git config --local user.email "tuanductran.dev@gmail.com"
          git config --local user.name "tuanductran"
          git add -A

          morning=(
            "chore(bot): 🌅 Sunrise brings fresh updates"
            "chore(bot): 🍩 Sweet morning break, sweet commit"
            "chore(bot): 📚 Reading paused for a repository update"
            "chore(bot): 🚶 Gentle stroll, steady commit"
          )

          daytime=(
            "chore(bot): 🛋️ Comfortable midday commit"
            "chore(bot): 🍔 Lunch break update"
            "chore(bot): 🍦 Ice cream in one hand, commit in the other"
            "chore(bot): 🎵 Background music, foreground commit"
            "chore(bot): 📺 Quick update between streaming sessions"
            "chore(bot): 🍹 Casual commit during a lazy break"
          )

          afternoon=(
            "chore(bot): 🌸 Calm and unhurried commit"
            "chore(bot): 🛋️ Relaxed afternoon update"
            "chore(bot): 🚶 Slow-paced commit executed"
            "chore(bot): 🍕 Pizza-powered update"
            "chore(bot): 📺 Paused a show to commit updates"
          )

          evening=(
            "chore(bot): 🥱 Low-energy evening update"
            "chore(bot): 🎮 Pausing the game for a short commit"
            "chore(bot): 📚 Book break interrupted for a quick commit"
            "chore(bot): 🌴 Vacation mood, but code still delivered"
            "chore(bot): 🛋️ Lounging with a light commit"
          )

          night=(
            "chore(bot): 🌙 Night shift commit, keeping the repo alive"
            "chore(bot): 💤 Automated commit triggered during idle hours"
            "chore(bot): 🥱 Commit generated while the bot was dozing off"
            "chore(bot): 😴 Sleep mode activated, but code still updated"
            "chore(bot): 🛌 Under the covers, yet updates continue"
            "chore(bot): 🛏️ Late-night commit before shutting down"
            "chore(bot): 🥱 Twilight commit before sleep"
            "chore(bot): 🌙 Night owl commit, keeping things running"
          )

          randoms=(
            "chore(bot): 🚫 Procrastination complete, commit delivered"
            "chore(bot): 🚫 Avoiding tasks, but not this commit"
            "chore(bot): 💤 Background task, foreground commit"
            "chore(bot): 😴 Dreaming of stable code, committing anyway"
            "chore(bot): 🥱 Quick commit made in pajamas"
            "chore(bot): 🥱 Fighting drowsiness with a commit"
            "chore(bot): 🍔 Food coma couldn’t stop this commit"
            "chore(bot): 🍕 Extra slice, extra commit"
            "chore(bot): 🎮 Game break turned into code push"
            "chore(bot): 📺 Dual-tasking: streaming and committing"
          )

          hour=$(date -u +"%H")
          if [ $hour -ge 5 ] && [ $hour -lt 11 ]; then
            pool=("${morning[@]}")
          elif [ $hour -ge 11 ] && [ $hour -lt 15 ]; then
            pool=("${daytime[@]}")
          elif [ $hour -ge 15 ] && [ $hour -lt 18 ]; then
            pool=("${afternoon[@]}")
          elif [ $hour -ge 18 ] && [ $hour -lt 22 ]; then
            pool=("${evening[@]}")
          else
            pool=("${night[@]}")
          fi

          if [ $((RANDOM % 5)) -eq 0 ]; then
            pool+=("${randoms[@]}")
          fi

          msg=${pool[$RANDOM % ${#pool[@]}]}
          git commit -m "$msg"

      - name: Push to GitHub
        uses: ad-m/github-push-action@master
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
        env:
          CI: true
